<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot met Spraak</title>
    <style>
        /* ... (CSS-stijlen zoals eerder) ... */
    </style>
</head>
<body class="bright-mode">
    <h1>Chatbot met Spraak</h1>
    <button id="toggle-mode" onclick="toggleMode()">Wissel modus</button>
    <button id="toggle-language" onclick="toggleLanguage()">Wissel taal</button>
    <div id="menu">
        <div class="menu-item" onclick="changeLanguage('nl-NL')">Nederlands</div>
        <div class="menu-item" onclick="changeLanguage('en-US')">English</div>
    </div>
    <div id="chat-container"></div>
    <input type="text" id="user-input" placeholder="Spreek hier..." onkeydown="handleKeyPress(event)" />
    <button id="speak-button" onclick="startListening()">Luister</button>

    <script>
        const chatContainer = document.getElementById('chat-container');
        const userInput = document.getElementById('user-input');
        const recognition = new webkitSpeechRecognition() || new SpeechRecognition();
        const synth = window.speechSynthesis;

        recognition.lang = 'nl-NL';

        const roepnaam = 'chatbot';
        let isDarkMode = false;

        // Geheugen voor het bijhouden van gebruikersinvoer
        const userMemory = {};

        function toggleMode() {
            const body = document.body;
            body.classList.toggle('dark-mode');
        }

        function toggleLanguage() {
            const menu = document.getElementById('menu');
            menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
        }

        function changeLanguage(lang) {
            recognition.lang = lang;
            toggleLanguage();
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                const userMessage = userInput.value;
                appendMessage('Jij', userMessage, 'user-message');
                handleUserInput(userMessage, false);
                userInput.value = '';
            }
        }

        function startListening() {
            recognition.onresult = function (event) {
                const transcript = event.results[0][0].transcript.toLowerCase();
                appendMessage('Jij', transcript, 'user-message');
                if (transcript.includes(roepnaam)) {
                    handleCommand(transcript);
                } else {
                    handleUserInput(transcript, true);
                }
            };

            recognition.start();
        }

        function appendMessage(sender, message, className) {
            const messageDiv = document.createElement('div');
            messageDiv.innerHTML = `<span class="${className}">${sender}: ${message}</span>`;
            chatContainer.appendChild(messageDiv);
        }

        function handleUserInput(userMessage, isSpeech) {
            const lowerUserMessage = userMessage.toLowerCase();

            if (lowerUserMessage.includes('grotekleuter')) {
                const botMemory = userMemory['grotekleuter'] || { responses: [] };
                const botResponse = getBotResponse(botMemory.responses);
                appendMessage('Chatbot', botResponse, 'bot-message');
                speakText(botResponse);

                // Voeg gebruikersinvoer toe aan het geheugen
                botMemory.responses.push(lowerUserMessage);
                userMemory['grotekleuter'] = botMemory;
            } else if (isSpeech && lowerUserMessage.includes('plus')) {
                // Voeg gebruikersinvoer toe aan het geheugen
                addToMemory('grotekleuter', userMessage);

                // Voer een bewerking uit en geef het resultaat weer
                const result = performOperation(userMessage);
                const botResponse = `Het resultaat is ${result}.`;
                appendMessage('Chatbot', botResponse, 'bot-message');
                speakText(botResponse);
            } else {
                // Voeg gebruikersinvoer toe aan het geheugen
                addToMemory('grotekleuter', userMessage);

                const botMemory = userMemory['grotekleuter'] || { responses: [] };
                const botResponse = getBotResponse(botMemory.responses);
                appendMessage('Chatbot', botResponse, 'bot-message');
                speakText(botResponse);
            }
        }

        function addToMemory(key, value) {
            const botMemory = userMemory[key] || { responses: [] };
            botMemory.responses.push(value.toLowerCase());
            userMemory[key] = botMemory;
        }

        function getBotResponse(responses) {
            if (responses && responses.length > 0) {
                return responses[Math.floor(Math.random() * responses.length)];
            } else {
                return getRandomResponse();
            }
        }

        function getRandomResponse() {
            const randomResponses = [
                'Ik begrijp niet helemaal wat je zegt.',
                'Kun je dat herhalen?',
                'Wat kan ik voor je doen?'
            ];
            return randomResponses[Math.floor(Math.random() * randomResponses.length)];
        }

        function speakText(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            synth.speak(utterance);
        }
    </script>
</body>
</html>



